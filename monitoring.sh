#!/bin/bash

# ============================================
# Скрипт для сбора информации о процессах из /proc
# ============================================

# Функция для проверки, является ли строка числом
is_number() {
    [[ $1 =~ ^[0-9]+$ ]]
}

# Массив для хранения PID
pids=()

echo "Начинаем сканирование директории /proc..."
echo "=========================================="

# Проходим по всем элементам в /proc
for item in /proc/*; do
    # Проверяем, что это директория
    if [ -d "$item" ]; then
        # Получаем имя директории
        name=$(basename "$item")
        
        # Проверяем, является ли имя числом (PID)
        if is_number "$name"; then
            pids+=("$name")
            echo "Найден процесс с PID: $name"
        fi
    fi
done

echo "=========================================="
echo "Всего найдено процессов: ${#pids[@]}"

# Если нужно сохранить в файл
output_file="proc_dirs_$(date +%Y%m%d_%H%M%S).txt"
printf "%s\n" "${pids[@]}" > "$output_file"
echo "Список PID сохранен в файл: $output_file"

# Показать первые 10 процессов для примера
echo ""
echo "Первые 10 процессов (для примера):"
echo "${pids[@]:0:10}" | tr ' ' '\n' | sort -n
